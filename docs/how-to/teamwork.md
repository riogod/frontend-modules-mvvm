# Организация работы команд в монорепозитории

Руководство по организации эффективной командной разработки в MFP (Modular Frontend Platform) с использованием монорепозитория и Module Federation.

## Обзор подхода

MFP построена как **монорепозиторий** с поддержкой **независимой разработки модулей** разными командами. Каждая команда может работать над своим модулем, используя общую инфраструктуру платформы.

### Ключевые принципы

- **Изоляция команд**: Каждая команда работает в своем модуле
- **Общие ресурсы**: Библиотеки и инфраструктура разделяются между командами
- **Независимые релизы**: Модули могут деплоиться независимо
- **Единые стандарты**: Общие правила разработки и архитектуры

## Структура командной работы

### Гибкая организация модулей

MFP поддерживает различные стратегии организации модулей в зависимости от потребностей проекта и команд:

#### Организация по бизнес-доменам

```
frontend-modules-mvvm/
├── packages/           # Модули по бизнес-доменам
│   ├── user-management/    # Команда авторизации
│   ├── catalog/            # Команда каталога
│   ├── orders/             # Команда заказов
│   └── analytics/          # Команда аналитики
├── libs/               # Общие библиотеки
│   ├── core/           # Команда платформы
│   ├── common/         # Команда платформы
│   ├── ui/             # Команда UI/UX
│   └── share/          # Совместные компоненты
└── host/               # Команда платформы
```

#### Организация по ответственностям команд

```
frontend-modules-mvvm/
├── packages/           # Модули по командам
│   ├── team-1/         # Команда 1
│   ├── team-2/         # Команда 2
│   ├── team-3/         # Команда 3
│   ├── team-4/         # Команда 4
├── libs/               # Общие библиотеки
│   ├── core/           # Команда платформы
│   ├── common/         # Команда платформы
│   ├── ui/             # Команда UI/UX
│   └── share/          # Совместные компоненты
└── host/               # Команда платформы
```

#### Смешанная организация

```
frontend-modules-mvvm/
├── packages/
│   ├── auth/               # Авторизация (один домен)
│   ├── catalog/            # Каталог товаров
│   │   ├── catalog-list/
│   │   ├── catalog-search/
│   │   └── catalog-admin/
│   ├── orders/             # Заказы
├── libs/               # Общие библиотеки
└── host/               # Хост-приложение
```

### Выбор стратегии организации

| Стратегия       | Преимущества                                  | Недостатки                             | Когда использовать                            |
| --------------- | --------------------------------------------- | -------------------------------------- | --------------------------------------------- |
| **По доменам**  | Четкая бизнес-логика, простая навигация       | Команды могут быть перегружены         | Маленькие команды, простая доменная модель    |
| **По командам** | Полная ответственность команды, независимость | Сложная навигация, пересечения доменов | Большие команды, сложная бизнес-логика        |
| **Смешанная**   | Гибкость, баланс нагрузки                     | Сложность управления                   | Средние команды, эволюционирующая архитектура |

#### Принципы организации модулей

- **Независимость**: Модули могут разрабатываться и деплоиться отдельно
- **Масштабируемость**: Структура должна расти с командой и проектом
- **Прозрачность**: Названия модулей должны отражать их назначение

### Распределение ответственности

| Команда           | Ответственность            | Модули/Библиотеки                     |
| ----------------- | -------------------------- | ------------------------------------- |
| **Платформа**     | Инфраструктура, CI/CD      | `host/`, `libs/core/`, `libs/common/` |
| **UI/UX**         | Дизайн-система, компоненты | `libs/ui/`                            |
| **Общие ресурсы** | Совместные компоненты      | `libs/share/`                         |
| **Авторизация**   | Пользователи, права        | `packages/user-management/`           |
| **Каталог**       | Товары, категории          | `packages/catalog/`                   |
| **Заказы**        | Корзина, оформление        | `packages/orders/`                    |
| **Аналитика**     | Метрики, отчеты            | `packages/analytics/`                 |

## Code Review и качество

### Автоматизированные проверки

```bash
# Линтинг модуля
npm run lint:module -- my-feature

# Тестирование модуля
npm run test:module -- my-feature

```

### Правила code review

#### Для модулей

- ✅ Соблюдение MVVM паттерна
- ✅ Использование DI контейнера
- ✅ Наличие тестов для бизнес-логики
- ✅ Документирование API

#### Для библиотек

- ✅ Экспорт через index.ts
- ✅ Типизация всех публичных API
- ✅ Отсутствие побочных эффектов в импортах

### Работа с git

Для организации командной разработки рекомендуется GitFlow подход. Это обеспечивает предсказуемый процесс разработки и безопасные релизы в монорепозитории с множеством команд.

#### Уровни GitFlow в монорепозитории

**Проектный уровень:**

- `main` — продакшен код всего проекта
- `develop` — интеграция всех фич от всех команд
- `release/*` — подготовка общих релизов
- `hotfix/*` — срочные исправления в продакшене

**Командный уровень:**
Команды могут организовывать свою работу по GitFlow внутри своих модулей, включая создание командных release веток:

```
project/
├── main (общий продакшен)
├── develop (общая интеграция)
├── release/v1.2.0 (общий релиз проекта)
├── team-a/
│   ├── feature/team-a-feature-1
│   ├── feature/team-a-feature-2
│   └── release/team-a-v1.0.0 (релиз модулей команды A)
└── team-b/
    ├── feature/team-b-feature-1
    ├── feature/team-b-feature-2
    └── release/team-b-v2.1.0 (релиз модулей команды B)
```

**Варианты организации разработки:**

**Вариант 1: Централизованный GitFlow (рекомендуется для небольших команд)**

- Все команды работают напрямую с общими ветками проекта
- Быстрая интеграция и простота координации
- Подходит для проектов с частыми релизами

**Вариант 2: Децентрализованный GitFlow (рекомендуется для больших команд)**

- Команды используют свои ветки для автономной разработки
- Интеграция происходит через командные release ветки
- Подходит для проектов со сложной релизной политикой

**Релизный процесс (децентрализованный вариант):**

1. Команды создают `release/team-*-vX.X.X` ветки для тестирования своих модулей
2. После успешного тестирования изменения сливаются в общую `develop` ветку

**Выбор подхода зависит от:**

- Размера команд и количества разработчиков
- Частоты релизов и сложности интеграции
- Требований к качеству и тестированию
- Корпоративных стандартов разработки

**Важно:** Независимо от выбранного подхода, все изменения команд обязательно попадают в общие `main` и `develop` ветки для поддержания актуальности всего проекта.

#### Основные ветки

| Ветка       | Назначение          | Создание от | Слияние в              |
| ----------- | ------------------- | ----------- | ---------------------- |
| `main`      | Продакшен код       | -           | -                      |
| `develop`   | Интеграция фич      | `main`      | `main` (через release) |
| `feature/*` | Разработка фич      | `develop`   | `develop`              |
| `release/*` | Подготовка релиза   | `develop`   | `main`, `develop`      |
| `hotfix/*`  | Срочные исправления | `main`      | `main`, `develop`      |

#### Правила коммитов

Используйте Conventional Commits:

```
feat: add new user authentication module
fix: resolve memory leak in data loader
docs: update API documentation
refactor: simplify component architecture
chore: update dependencies to latest versions
```

#### Code Review процесс

1. **Pull Request** создается в ветку `develop`
2. **Обязательные проверки:**
   - CI/CD пайплайн прошел
   - Линтинг и тесты пройдены
   - Code review от минимум 1 разработчика
3. **Merge** только через "Squash and merge" для чистой истории
4. **Удаление** feature веток после мерджа

## Связанные разделы

- [Структура проекта](../project-structure.md)
- [Создание модуля](../modules/creating-module.md)
- [Межмодульное взаимодействие](../modules/inter-module-communication.md)
- [Лаунчер](../tools/launcher.md)
- [Module Federation](https://webpack.js.org/concepts/module-federation/)
