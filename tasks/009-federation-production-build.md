# –ó–∞–¥–∞—á–∞ 009: Federation Production Build

## –°—Ç–∞—Ç—É—Å: ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–∞

## –û–ø–∏—Å–∞–Ω–∏–µ

–ù–∞—Å—Ç—Ä–æ–π–∫–∞ production —Å–±–æ—Ä–∫–∏ –º–æ–¥—É–ª–µ–π —Å Module Federation –∏ —Å–æ–∑–¥–∞–Ω–∏–µ build —Å–∫—Ä–∏–ø—Ç–æ–≤ –¥–ª—è —Å–±–æ—Ä–∫–∏ –º–æ–¥—É–ª–µ–π –∏ host –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

**–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–∞—Ü–∏—è —É—Ç–∏–ª–∏—Ç**: Build —É—Ç–∏–ª–∏—Ç—ã (`getModuleVersion`, `discoverModules`) —Ä–∞–∑–º–µ—â–µ–Ω—ã –≤ `@platform/vite-config/build-utils/` –¥–ª—è –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–∞–Ω–∏—Ñ–µ—Å—Ç–∞**: –í production –º–∞–Ω–∏—Ñ–µ—Å—Ç –º–æ–¥—É–ª–µ–π –ø–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è **–±—ç–∫–µ–Ω–¥–æ–º —á–µ—Ä–µ–∑ `/app/start`**. –ë—ç–∫–µ–Ω–¥ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ —É–ø—Ä–∞–≤–ª—è–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π –º–æ–¥—É–ª–µ–π (–ë–î/–∫–æ–Ω—Ñ–∏–≥). –°—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –º–∞–Ω–∏—Ñ–µ—Å—Ç–∞ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è.

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

- **–ó–∞–¥–∞—á–∞ 002**: –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è Vite –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (createModuleConfig) ‚úÖ
- **–ó–∞–¥–∞—á–∞ 006**: Vite –ø–ª–∞–≥–∏–Ω—ã (—Ç–∏–ø—ã –º–∞–Ω–∏—Ñ–µ—Å—Ç–∞ `AppManifest`) ‚úÖ
- **–ó–∞–¥–∞—á–∞ 008**: RemoteModuleLoader (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–≥—Ä—É–∑–∫–∏) ‚úÖ

## –ß—Ç–æ —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

- ‚úÖ –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è `config/vite-config/build-utils/` —Å–æ–∑–¥–∞–Ω–∞
- ‚úÖ `utils.ts` —Å —Ñ—É–Ω–∫—Ü–∏—è–º–∏ `getModuleVersion`, `discoverModules`, `isModuleBuilt`
- ‚úÖ `generateManifest.ts` (–¥–ª—è dev/preview, –Ω–µ –¥–ª—è production)
- ‚úÖ `index.ts` —Å —Ä–µ—ç–∫—Å–ø–æ—Ä—Ç–æ–º —É—Ç–∏–ª–∏—Ç
- ‚úÖ –¢–∏–ø—ã `ModuleManifestEntry` –∏ `ModuleLoadType` –≤ `@platform/core`

## –ü–æ–¥–∑–∞–¥–∞—á–∏

### 1. ‚úÖ Build —É—Ç–∏–ª–∏—Ç—ã –≤ @platform/vite-config (–í–´–ü–û–õ–ù–ï–ù–û)

–£—Ç–∏–ª–∏—Ç—ã —É–∂–µ —Å–æ–∑–¥–∞–Ω—ã –≤ `config/vite-config/build-utils/`:

**`config/vite-config/build-utils/utils.ts`** ‚Äî —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:

```typescript
import fs from 'fs';
import path from 'path';

export function getModuleVersion(modulePath: string): string;
export function discoverModules(packagesDir: string): string[];
export function isModuleBuilt(distDir: string, moduleName: string): boolean;
```

### 2. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å —ç–∫—Å–ø–æ—Ä—Ç—ã build-utils –≤ index.js (–í–´–ü–û–õ–ù–ï–ù–û)

- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω `config/vite-config/index.js`:

```javascript
// Build —É—Ç–∏–ª–∏—Ç—ã
export {
  getModuleVersion,
  discoverModules,
  isModuleBuilt,
} from './build-utils/index.js';
```

### 3. ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å outDir –≤ module.config.js (–í–´–ü–û–õ–ù–ï–ù–û)

- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω `config/vite-config/module.config.js`:

```javascript
outDir = `../../dist/modules/${moduleName}/latest`,
```

–≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –µ–¥–∏–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É:

- `dist/modules/{module_name}/latest/remoteEntry.js` (–≤ –∫–æ—Ä–Ω–µ, –Ω–µ –≤ assets/)

### 4. ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å isModuleBuilt –¥–ª—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏ (–í–´–ü–û–õ–ù–ï–ù–û)

- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω `config/vite-config/build-utils/utils.ts`:

```typescript
/**
 * –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —Å–æ–±—Ä–∞–Ω –ª–∏ –º–æ–¥—É–ª—å (–µ—Å—Ç—å remoteEntry.js)
 */
export function isModuleBuilt(distDir: string, moduleName: string): boolean {
  const remoteEntry = path.join(
    distDir,
    moduleName,
    'latest',
    'remoteEntry.js', // –í –∫–æ—Ä–Ω–µ, –Ω–µ –≤ assets/
  );
  return fs.existsSync(remoteEntry);
}
```

### 5. ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ build-module.mjs —Å–∫—Ä–∏–ø—Ç–∞ (–í–´–ü–û–õ–ù–ï–ù–û)

- ‚úÖ –°–æ–∑–¥–∞–Ω `scripts/build-module.mjs` —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π:
  - –°–±–æ—Ä–∫–∏ –≤ `latest/`
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –≤ `{version}/`
  - –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π —Å–±–æ—Ä–∫–∏ (`--parallel`)
  - –ê–Ω–∞–ª–∏–∑–∞ –±–∞–Ω–¥–ª–æ–≤ (`--analyze`)
  - –°–±–æ—Ä–∫–∏ –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π (`--all`)
  - **–û—á–∏—Å—Ç–∫–∏ –ø–∞–ø–∫–∏ –º–æ–¥—É–ª—è –ø–µ—Ä–µ–¥ —Å–±–æ—Ä–∫–æ–π**
  - **–†–µ–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã (—É–¥–∞–ª–µ–Ω–∏–µ index.html, –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –∏–∑ assets/ –≤ –∫–æ—Ä–µ–Ω—å)**

### 6. ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ package.json scripts (–í–´–ü–û–õ–ù–ï–ù–û)

- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã build —Å–∫—Ä–∏–ø—Ç—ã –≤ –∫–æ—Ä–Ω–µ–≤–æ–π `package.json`:

```json
{
  "scripts": {
    "build": "npm run build:host",
    "build:host": "vite build --config host/vite.config.mts",
    "build:module": "node scripts/build-module.mjs",
    "build:modules": "node scripts/build-module.mjs --all",
    "build:modules:parallel": "node scripts/build-module.mjs --all --parallel",
    "build:all": "npm run build:modules && npm run build:host",
    "preview:host": "vite preview --config host/vite.config.mts",
    "analyze:module": "node scripts/build-module.mjs --analyze"
  }
}
```

### 7. ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Host –¥–ª—è production (–í–´–ü–û–õ–ù–ï–ù–û)

- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω `config/vite-config/host.config.js`:
  - –î–æ–±–∞–≤–ª–µ–Ω –ø–ª–∞–≥–∏–Ω `cleanDistPreserveModulesPlugin` –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–∞–ø–∫–∏ `modules` –ø—Ä–∏ –æ—á–∏—Å—Ç–∫–µ `dist`
  - `emptyOutDir: false` —Å –∫–∞—Å—Ç–æ–º–Ω–æ–π –ª–æ–≥–∏–∫–æ–π –æ—á–∏—Å—Ç–∫–∏

### 8. ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –º–æ–¥—É–ª–µ–π (–í–´–ü–û–õ–ù–ï–ù–û)

- ‚úÖ –°–æ–∑–¥–∞–Ω `scripts/version-module.mjs`:
  - –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –º–æ–¥—É–ª–µ–π
  - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ patch/minor/major

### 9. ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ production —Å–±–æ—Ä–∫–∏ (–í–´–ü–û–õ–ù–ï–ù–û)

- ‚úÖ –°–æ–±—Ä–∞–Ω—ã –≤—Å–µ –º–æ–¥—É–ª–∏: `npm run build:modules`
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ dist/modules/:
  - `remoteEntry.js` –≤ –∫–æ—Ä–Ω–µ –º–æ–¥—É–ª—è ‚úÖ
  - `index.html` —É–¥–∞–ª–µ–Ω ‚úÖ
  - –ü–∞–ø–∫–∞ `assets/` —É–¥–∞–ª–µ–Ω–∞ ‚úÖ
  - –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–ø–∏–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è ‚úÖ
- ‚úÖ –°–æ–±—Ä–∞–Ω host: `npm run build:host`
- ‚úÖ –ü–∞–ø–∫–∞ `modules/` —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ø—Ä–∏ —Å–±–æ—Ä–∫–µ host ‚úÖ

## Definition of Done (DoD)

1. ‚úÖ Build —É—Ç–∏–ª–∏—Ç—ã —Ä–∞–∑–º–µ—â–µ–Ω—ã –≤ `@platform/vite-config/build-utils/`
2. ‚úÖ –≠–∫—Å–ø–æ—Ä—Ç—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ `config/vite-config/index.js`
3. ‚úÖ outDir –≤ module.config.js –∏–∑–º–µ–Ω–µ–Ω –Ω–∞ `dist/modules/{module}/latest`
4. ‚úÖ `build-module.mjs` —Å–æ–∑–¥–∞–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
5. ‚úÖ –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è —Å–±–æ—Ä–∫–∞ –º–æ–¥—É–ª–µ–π —Ä–∞–±–æ—Ç–∞–µ—Ç (--parallel)
6. ‚úÖ –ú–æ–¥—É–ª–∏ —Å–æ–±–∏—Ä–∞—é—Ç—Å—è –≤ `/dist/modules/{module_name}/latest/` (—Ñ–∞–π–ª—ã –≤ –∫–æ—Ä–Ω–µ)
7. ‚úÖ Host —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è –≤ `/dist`
8. ‚úÖ –ü–∞–ø–∫–∞ `modules/` —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ø—Ä–∏ —Å–±–æ—Ä–∫–µ host
9. ‚úÖ –û—á–∏—Å—Ç–∫–∞ –ø–∞–ø–∫–∏ –º–æ–¥—É–ª—è –ø–µ—Ä–µ–¥ —Å–±–æ—Ä–∫–æ–π —Ä–∞–±–æ—Ç–∞–µ—Ç
10. ‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–¥—É–ª—è: —Ñ–∞–π–ª—ã –≤ –∫–æ—Ä–Ω–µ, –±–µ–∑ index.html –∏ assets/

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ú–∞–Ω–∏—Ñ–µ—Å—Ç –º–æ–¥—É–ª–µ–π

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                         Production                               ‚îÇ
‚îÇ                                                                  ‚îÇ
‚îÇ   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     GET /app/start      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ
‚îÇ   ‚îÇ  Host    ‚îÇ ‚óÑ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ ‚îÇ     Backend      ‚îÇ    ‚îÇ
‚îÇ   ‚îÇ  App     ‚îÇ                         ‚îÇ  (–ë–î/–ö–æ–Ω—Ñ–∏–≥)     ‚îÇ    ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ
‚îÇ        ‚îÇ                                        ‚îÇ               ‚îÇ
‚îÇ        ‚îÇ –ú–∞–Ω–∏—Ñ–µ—Å—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç:                     ‚îÇ               ‚îÇ
‚îÇ        ‚îÇ - modules[]                            ‚îÇ               ‚îÇ
‚îÇ        ‚îÇ - remoteEntry URLs                     ‚îÇ               ‚îÇ
‚îÇ        ‚îÇ - features, permissions                ‚îÇ               ‚îÇ
‚îÇ        ‚ñº                                        ‚ñº               ‚îÇ
‚îÇ   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îÇ
‚îÇ   ‚îÇ              CDN / Static Server                  ‚îÇ         ‚îÇ
‚îÇ   ‚îÇ   /modules/todo/latest/remoteEntry.js            ‚îÇ         ‚îÇ
‚îÇ   ‚îÇ   /modules/api_example/latest/remoteEntry.js      ‚îÇ         ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã

```
config/vite-config/
‚îú‚îÄ‚îÄ plugins/                    # –ü–ª–∞–≥–∏–Ω—ã (–∑–∞–¥–∞—á–∞ 006)
‚îÇ   ‚îú‚îÄ‚îÄ types.ts               # üîë –ï–î–ò–ù–´–ô –ò–°–¢–û–ß–ù–ò–ö —Ç–∏–ø–æ–≤ –º–∞–Ω–∏—Ñ–µ—Å—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ moduleAliases.ts
‚îÇ   ‚îú‚îÄ‚îÄ manifestMiddleware.ts
‚îÇ   ‚îú‚îÄ‚îÄ loadManifest.ts
‚îÇ   ‚îî‚îÄ‚îÄ index.ts
‚îú‚îÄ‚îÄ build-utils/               # ‚úÖ Build —É—Ç–∏–ª–∏—Ç—ã (—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ)
‚îÇ   ‚îú‚îÄ‚îÄ utils.ts               # getModuleVersion, discoverModules, isModuleBuilt
‚îÇ   ‚îú‚îÄ‚îÄ generateManifest.ts    # –î–ª—è dev/preview (–Ω–µ –¥–ª—è production)
‚îÇ   ‚îî‚îÄ‚îÄ index.ts
‚îú‚îÄ‚îÄ host.config.ts             # ‚úÖ –ü–ª–∞–≥–∏–Ω —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è modules/
‚îú‚îÄ‚îÄ module.config.js            # ‚úÖ outDir –Ω–∞—Å—Ç—Ä–æ–µ–Ω, —Ñ–∞–π–ª—ã –≤ –∫–æ—Ä–µ–Ω—å
‚îî‚îÄ‚îÄ index.js                   # ‚úÖ –≠–∫—Å–ø–æ—Ä—Ç—ã build-utils –¥–æ–±–∞–≤–ª–µ–Ω—ã
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ dist –ø–æ—Å–ª–µ —Å–±–æ—Ä–∫–∏

```
dist/
‚îú‚îÄ‚îÄ index.html                      # Host Application
‚îú‚îÄ‚îÄ assets/
‚îÇ   ‚îú‚îÄ‚îÄ index-[hash].js
‚îÇ   ‚îú‚îÄ‚îÄ index-[hash].css
‚îÇ   ‚îú‚îÄ‚îÄ lib-core-[hash].js
‚îÇ   ‚îú‚îÄ‚îÄ lib-ui-[hash].js
‚îÇ   ‚îú‚îÄ‚îÄ lib-common-[hash].js
‚îÇ   ‚îú‚îÄ‚îÄ vendor-[hash].js
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ
‚îî‚îÄ‚îÄ modules/                        # MFE –º–æ–¥—É–ª–∏ (–¥–µ–ø–ª–æ—è—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ)
    ‚îú‚îÄ‚îÄ todo/
    ‚îÇ   ‚îú‚îÄ‚îÄ latest/                 # –í—Å–µ–≥–¥–∞ –∞–∫—Ç—É–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è
    ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ remoteEntry.js      # –í –∫–æ—Ä–Ω–µ, –Ω–µ –≤ assets/
    ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ index-*.js
    ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __federation_*.js
    ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
    ‚îÇ   ‚îî‚îÄ‚îÄ 1.0.0/                  # –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∫–æ–ø–∏—è
    ‚îÇ       ‚îú‚îÄ‚îÄ remoteEntry.js
    ‚îÇ       ‚îî‚îÄ‚îÄ ...
    ‚îÇ
    ‚îî‚îÄ‚îÄ api_example/
        ‚îú‚îÄ‚îÄ latest/
        ‚îÇ   ‚îú‚îÄ‚îÄ remoteEntry.js
        ‚îÇ   ‚îî‚îÄ‚îÄ ...
        ‚îî‚îÄ‚îÄ 1.0.0/
            ‚îú‚îÄ‚îÄ remoteEntry.js
            ‚îî‚îÄ‚îÄ ...
```

**–í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–¥—É–ª–µ–π:**

- `latest/` ‚Äî –≤—Å–µ–≥–¥–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –∞–∫—Ç—É–∞–ª—å–Ω—É—é —Å–±–æ—Ä–∫—É
- `{version}/` ‚Äî –∫–æ–ø–∏—è –¥–ª—è rollback, A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, –∫–∞–Ω–∞—Ä–µ–µ—á–Ω—ã—Ö —Ä–µ–ª–∏–∑–æ–≤

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–¥—É–ª—è:**

- –í—Å–µ —Ñ–∞–π–ª—ã –≤ –∫–æ—Ä–Ω–µ –º–æ–¥—É–ª—è (–Ω–µ –≤ `assets/`)
- `index.html` –Ω–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è
- `remoteEntry.js` –≤ –∫–æ—Ä–Ω–µ –¥–ª—è —É–¥–æ–±–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞

> **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: `manifest.json` –ù–ï –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏. –ú–∞–Ω–∏—Ñ–µ—Å—Ç –ø–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –±—ç–∫–µ–Ω–¥–æ–º —á–µ—Ä–µ–∑ `/app/start`. –ë—ç–∫–µ–Ω–¥ –º–æ–∂–µ—Ç —É–∫–∞–∑—ã–≤–∞—Ç—å –∫–∞–∫ `latest`, —Ç–∞–∫ –∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –≤–µ—Ä—Å–∏—é –≤ `remoteEntry` URL.

## –†–∏—Å–∫–∏ –∏ –º–∏—Ç–∏–≥–∞—Ü–∏—è

| –†–∏—Å–∫                               | –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å | –í–ª–∏—è–Ω–∏–µ | –ú–∏—Ç–∏–≥–∞—Ü–∏—è                                |
| ---------------------------------- | ----------- | ------- | ---------------------------------------- |
| –ù–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –≤–µ—Ä—Å–∏–π shared deps | –°—Ä–µ–¥–Ω—è—è     | –í—ã—Å–æ–∫–æ–µ | –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, lock —Ñ–∞–π–ª—ã                 |
| –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –≤–µ—Ä—Å–∏–π          | –°—Ä–µ–¥–Ω—è—è     | –°—Ä–µ–¥–Ω–µ–µ | Cache busting —á–µ—Ä–µ–∑ hash –≤ –∏–º–µ–Ω–∞—Ö —Ñ–∞–π–ª–æ–≤ |
| –ë–æ–ª—å—à–æ–π —Ä–∞–∑–º–µ—Ä –±–∞–Ω–¥–ª–æ–≤             | –°—Ä–µ–¥–Ω—è—è     | –°—Ä–µ–¥–Ω–µ–µ | Bundle analyzer, code splitting          |

## –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

**–§–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –≤—Ä–µ–º—è**: **~4 —á–∞—Å–∞** (–≤–∫–ª—é—á–∞—è –¥–æ—Ä–∞–±–æ—Ç–∫–∏ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)

## –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- ‚úÖ Build —É—Ç–∏–ª–∏—Ç—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –≤ `@platform/vite-config/build-utils/`
- ‚úÖ –¢–∏–ø—ã –º–∞–Ω–∏—Ñ–µ—Å—Ç–∞ –±–µ—Ä—É—Ç—Å—è –∏–∑ `@platform/vite-config/plugins/types.ts` (—Ä–µ—ç–∫—Å–ø–æ—Ä—Ç –∏–∑ `@platform/core`)
- ‚úÖ **–ú–∞–Ω–∏—Ñ–µ—Å—Ç –ø–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –±—ç–∫–µ–Ω–¥–æ–º** —á–µ—Ä–µ–∑ `/app/start` ‚Äî —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è
- ‚úÖ –ú–æ–¥—É–ª–∏ —Å–æ–±–∏—Ä–∞—é—Ç—Å—è –≤ `/dist/modules/{module_name}/latest/` + –∫–æ–ø–∏—è –≤ `/{version}/`
- ‚úÖ Host —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è –≤ `/dist` (–∫–æ—Ä–Ω–µ–≤–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è dist)
- ‚úÖ –ë—ç–∫–µ–Ω–¥ –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `latest` –∏–ª–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –≤–µ—Ä—Å–∏—é –≤ `remoteEntry` URL
- ‚úÖ **–ü–∞–ø–∫–∞ `modules/` —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ø—Ä–∏ —Å–±–æ—Ä–∫–µ host** (–ø–ª–∞–≥–∏–Ω `cleanDistPreserveModulesPlugin`)
- ‚úÖ **–ü–∞–ø–∫–∞ –º–æ–¥—É–ª—è –æ—á–∏—â–∞–µ—Ç—Å—è –ø–µ—Ä–µ–¥ —Å–±–æ—Ä–∫–æ–π** (—É–¥–∞–ª—è—é—Ç—Å—è —Å—Ç–∞—Ä—ã–µ –≤–µ—Ä—Å–∏–∏)
- ‚úÖ **–§–∞–π–ª—ã –º–æ–¥—É–ª—è –≤ –∫–æ—Ä–Ω–µ** (–Ω–µ –≤ `assets/`), `index.html` –Ω–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è
