import {
  Meta,
  Canvas,
  Story,
  Controls,
  Description,
  ArgTypes,
} from '@storybook/addon-docs/blocks';
import * as useSharedComponentStories from './useSharedComponent.stories';

<Meta of={useSharedComponentStories} />

# useSharedComponent

<Description of={useSharedComponentStories} />

–•—É–∫ `useSharedComponent` –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è shared UI-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –∏–∑ DI –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞. –û–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏, –∫–æ—Ç–æ—Ä—ã–µ shared –º–µ–∂–¥—É –º–∏–∫—Ä–æ—Ñ—Ä–æ–Ω—Ç–æ–≤—ã–º–∏ –º–æ–¥—É–ª—è–º–∏ —á–µ—Ä–µ–∑ Module Federation.

---

## ‚ú® –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- ‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤** –∏–∑ DI –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –±–∏–Ω–¥–∏–Ω–≥–∞
- ‚úÖ **Fallback –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã** –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ø—Ä–æ—Ä—ã–≤–∞ –æ—à–∏–±–æ–∫ –±–∏–Ω–¥–∏–Ω–≥–∞ –Ω–∞—Ä—É–∂—É
- ‚úÖ **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ lazy –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤** —á–µ—Ä–µ–∑ React.lazy
- ‚úÖ **–í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤** –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- ‚úÖ **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π** –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –º–æ–¥—É–ª—è
- ‚úÖ **–ú–µ–º–æ–∏–∑–∞—Ü–∏—è** –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ª–∏—à–Ω–∏—Ö –ø–µ—Ä–µ—Ä–µ–Ω–¥–µ—Ä–æ–≤

---

## üéØ –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `useSharedComponent` –∫–æ–≥–¥–∞:

- **–ù—É–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∏–∑ –¥—Ä—É–≥–æ–≥–æ –º–æ–¥—É–ª—è** —á–µ—Ä–µ–∑ Module Federation
- **–ö–æ–º–ø–æ–Ω–µ–Ω—Ç –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω** (–º–æ–¥—É–ª—å –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω –∏–ª–∏ –Ω–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω)
- **–¢—Ä–µ–±—É–µ—Ç—Å—è graceful degradation** –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
- **–ù—É–∂–Ω–æ –∏–∑–±–µ–∂–∞—Ç—å –ø—Ä–æ—Ä—ã–≤–∞ –æ—à–∏–±–æ–∫ –±–∏–Ω–¥–∏–Ω–≥–∞** –Ω–∞—Ä—É–∂—É –∏ –ø–æ–ª–æ–º–∫–∏ –º–æ–¥—É–ª—è

---

## üìö API Reference

<ArgTypes of={useSharedComponentStories.WithComponent} />

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã

#### `containerKey: ServiceIdentifier<T>`

–ö–ª—é—á –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞, –ø–æ –∫–æ—Ç–æ—Ä–æ–º—É –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è –ø–æ–∏—Å–∫ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –≤ DI –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ.

**–¢–∏–ø:** `ServiceIdentifier<T>` (–æ–±—ã—á–Ω–æ —Å—Ç—Ä–æ–∫–∞ –∏–ª–∏ —Å–∏–º–≤–æ–ª)

**–ü—Ä–∏–º–µ—Ä:**

```tsx
const MyComponent = useSharedComponent('ApiCallExample');
```

#### `options?: UseSharedComponentOptions`

–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–≤–µ–¥–µ–Ω–∏—è —Ö—É–∫–∞.

**–°–≤–æ–π—Å—Ç–≤–∞:**

- **`moduleName?: string`** - –ù–∞–∑–≤–∞–Ω–∏–µ –º–æ–¥—É–ª—è, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –æ—à–∏–±–æ–∫ –≤ –ª–æ–≥–∞—Ö.

- **`validateComponent?: boolean`** - –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –ª–∏, —á—Ç–æ –ø–æ–ª—É—á–µ–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç —è–≤–ª—è–µ—Ç—Å—è React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–º. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: `true`.

- **`fallback?: ReactComponentType`** - Fallback –∫–æ–º–ø–æ–Ω–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –≤–æ–∑–≤—Ä–∞—â–µ–Ω, –µ—Å–ª–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ. **–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –≤—Å–µ–≥–¥–∞ —É–∫–∞–∑—ã–≤–∞—Ç—å** –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ø—Ä–æ—Ä—ã–≤–∞ –æ—à–∏–±–æ–∫ –±–∏–Ω–¥–∏–Ω–≥–∞.

- **`suppressErrors?: boolean`** - –ü–æ–¥–∞–≤–ª—è—Ç—å –ª–∏ –æ—à–∏–±–∫–∏ –∏ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å fallback –∏–ª–∏ null –≤–º–µ—Å—Ç–æ –≤—ã–±—Ä–æ—Å–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏—è. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: `true`. –ï—Å–ª–∏ `false`, –æ—à–∏–±–∫–∏ –±—É–¥—É—Ç –≤—ã–±—Ä–æ—à–µ–Ω—ã (–ø–æ–ª–µ–∑–Ω–æ –¥–ª—è —Å—Ç—Ä–æ–≥–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤ —Ç–µ—Å—Ç–∞—Ö).

### –í–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ

**–¢–∏–ø:** `T | null`

- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∏–∑ DI –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞, –µ—Å–ª–∏ –æ–Ω –Ω–∞–π–¥–µ–Ω
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç fallback –∫–æ–º–ø–æ–Ω–µ–Ω—Ç, –µ—Å–ª–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω –∏ `fallback` —É–∫–∞–∑–∞–Ω
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `null`, –µ—Å–ª–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω –∏ `fallback` –Ω–µ —É–∫–∞–∑–∞–Ω (–ø—Ä–∏ `suppressErrors: true`)
- –í—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç –æ—à–∏–±–∫—É, –µ—Å–ª–∏ `suppressErrors: false` –∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω

---

## üíª –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```tsx
import { useSharedComponent } from '@platform/ui';
import { Suspense } from 'react';

const MyPage = () => {
  const SharedComponent = useSharedComponent('component.key');

  return (
    <Suspense fallback={<div>–ó–∞–≥—Ä—É–∑–∫–∞...</div>}>
      {SharedComponent ? <SharedComponent /> : <div>–ö–æ–º–ø–æ–Ω–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω</div>}
    </Suspense>
  );
};
```

### –° fallback –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–º (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```tsx
import { useSharedComponent } from '@platform/ui';
import { Suspense } from 'react';
import { Typography } from '@mui/material';

const MyPage = () => {
  const SharedComponent = useSharedComponent('component.key', {
    fallback: () => (
      <Typography color="text.secondary">–ö–æ–º–ø–æ–Ω–µ–Ω—Ç –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω</Typography>
    ),
  });

  return (
    <Suspense fallback={<div>–ó–∞–≥—Ä—É–∑–∫–∞...</div>}>
      <SharedComponent />
    </Suspense>
  );
};
```

### –° —É–∫–∞–∑–∞–Ω–∏–µ–º –º–æ–¥—É–ª—è –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

```tsx
const SharedComponent = useSharedComponent('component.key', {
  moduleName: 'api-example',
  fallback: () => <div>–ö–æ–º–ø–æ–Ω–µ–Ω—Ç –∏–∑ api-example –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω</div>,
});
```

### –° lazy –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–º

```tsx
import { lazy, Suspense } from 'react';
import { useSharedComponent } from '@platform/ui';

const MyPage = () => {
  // Lazy –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∞–Ω —á–µ—Ä–µ–∑ Suspense
  const LazyComponent = useSharedComponent('lazy.component.key', {
    fallback: () => <div>–ö–æ–º–ø–æ–Ω–µ–Ω—Ç –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω</div>,
  });

  return (
    <Suspense fallback={<div>–ó–∞–≥—Ä—É–∑–∫–∞ lazy –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞...</div>}>
      <LazyComponent />
    </Suspense>
  );
};
```

### –°—Ç—Ä–æ–≥–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ (–¥–ª—è —Ç–µ—Å—Ç–æ–≤)

```tsx
// –í —Ç–µ—Å—Ç–∞—Ö –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å suppressErrors: false –¥–ª—è —Å—Ç—Ä–æ–≥–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏
const SharedComponent = useSharedComponent('component.key', {
  suppressErrors: false, // –í—ã–±—Ä–æ—Å–∏—Ç –æ—à–∏–±–∫—É, –µ—Å–ª–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω
});
```

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

### –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ fallback

**–í–∞–∂–Ω–æ:** –í—Å–µ–≥–¥–∞ —É–∫–∞–∑—ã–≤–∞–π—Ç–µ `fallback` –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ø—Ä–æ—Ä—ã–≤–∞ –æ—à–∏–±–æ–∫ –±–∏–Ω–¥–∏–Ω–≥–∞ –Ω–∞—Ä—É–∂—É –∏ –ø–æ–ª–æ–º–∫–∏ –º–æ–¥—É–ª—è.

```tsx
// ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ
const Component = useSharedComponent('key', {
  fallback: () => <div>–ù–µ–¥–æ—Å—Ç—É–ø–µ–Ω</div>,
});

// ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ (–º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –ø—Ä–æ—Ä—ã–≤—É –æ—à–∏–±–∫–∏)
const Component = useSharedComponent('key');
```

### –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Suspense –¥–ª—è lazy –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

–î–ª—è lazy –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ (–ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ `React.lazy`) –≤—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `<Suspense>`:

```tsx
<Suspense fallback={<div>–ó–∞–≥—Ä—É–∑–∫–∞...</div>}>
  <SharedComponent />
</Suspense>
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –±–∏–Ω–¥–∏–Ω–≥–∞

–•—É–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –±–∏–Ω–¥–∏–Ω–≥–∞ —á–µ—Ä–µ–∑ `container.isBound()` –ø–µ—Ä–µ–¥ –æ–±—Ä–∞—â–µ–Ω–∏–µ–º –∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É. –≠—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –≤—ã–±—Ä–∞—Å—ã–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ –∏ –ø—Ä–æ—Ä—ã–≤ –∏—Ö –Ω–∞—Ä—É–∂—É.

---

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —Ö—É–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ª–æ–≥–∏—Ä—É–µ—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è —á–µ—Ä–µ–∑ `@platform/core/log`:

- –ö–æ–≥–¥–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω
- –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è fallback –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
- –ö–æ–≥–¥–∞ DI –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ moduleName

–£–∫–∞–∑—ã–≤–∞–π—Ç–µ `moduleName` –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏:

```tsx
const Component = useSharedComponent('key', {
  moduleName: 'my-module', // –ü–æ–º–æ–∂–µ—Ç –≤ –ª–æ–≥–∞—Ö –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–æ–±–ª–µ–º—ã
  fallback: () => <div>–ù–µ–¥–æ—Å—Ç—É–ø–µ–Ω</div>,
});
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–í —Ç–µ—Å—Ç–∞—Ö –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `suppressErrors: false` –¥–ª—è —Å—Ç—Ä–æ–≥–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏:

```tsx
import { renderHook } from '@testing-library/react';
import { useSharedComponent } from '@platform/ui';

test('should throw error when component not found', () => {
  expect(() => {
    renderHook(() =>
      useSharedComponent('nonexistent', { suppressErrors: false }),
    );
  }).toThrow();
});
```

---

## üìñ –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ö—É–∫–∏

- [`useVM`](./useVM.mdx) - –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è view-–º–æ–¥–µ–ª–µ–π –∏–∑ DI –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
